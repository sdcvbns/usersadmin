<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>âœ¨ Ù„ÙˆØ­Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #28a745; 
      --primary-hover: #1f8738;
      --secondary-color: #007bff; 
      --bg-light: #f8f9fa; 
      --card-bg: #ffffff;
      --shadow-soft: 0 12px 24px rgba(0, 0, 0, 0.08);
      --danger-color: #dc3545;
      --warning-color: #ffc107;
    }

    /* ** Ø£Ù†ÙŠÙ…ÙŠØ´Ù† ÙˆØªØµÙ…ÙŠÙ… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ** */
    @keyframes fadeIn {
      to { opacity: 1; transform: translateY(0); }
    }

    body {
      font-family: 'Cairo', sans-serif;
      background: linear-gradient(135deg, var(--bg-light), #e3f2fd);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
      box-sizing: border-box;
      direction: rtl;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    .card {
      background: var(--card-bg);
      padding: 35px;
      width: 100%;
      max-width: 420px;
      border-radius: 20px;
      box-shadow: var(--shadow-soft);
      border-left: 6px solid var(--primary-color);
      box-sizing: border-box;
      opacity: 0;
      transform: translateY(20px);
      animation: fadeIn 0.8s forwards;
    }

    h3 {
      color: var(--primary-color);
      margin-top: 0;
      font-weight: 700;
      font-size: 1.8rem;
      text-align: center;
      margin-bottom: 25px;
    }

    /* ** Ø³ØªØ§ÙŠÙ„ Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙˆØ§Ù„Ø§Ø®ØªÙŠØ§Ø± ** */
    input, select {
      width: 100%;
      padding: 12px 15px;
      margin: 12px 0;
      border-radius: 10px;
      border: 1px solid #ddd;
      text-align: right;
      font-size: 16px;
      box-sizing: border-box;
      -webkit-user-select: text !important;
      -moz-user-select: text !important;
      -ms-user-select: text !important;
      user-select: text !important;
    }
    
    input:focus, select:focus {
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
      outline: none;
    }

    /* ** Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø± ** */
    button {
      color: white;
      border: none;
      padding: 12px;
      border-radius: 10px;
      cursor: pointer;
      width: 100%;
      font-size: 17px;
      font-weight: 600;
      margin-top: 15px;
      transition: background 0.3s, transform 0.2s, box-shadow 0.3s;
      background: var(--primary-color); 
    }

    button:hover { 
        box-shadow: 0 6px 12px rgba(40, 167, 69, 0.3);
    }
    button:active { 
        transform: scale(0.98); 
    }

    /* ** Ø£Ù„ÙˆØ§Ù† Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ** */
    .btn-suspend {
        background: var(--warning-color);
        color: #333;
        margin-top: 20px;
    }
    .btn-suspend:hover {
        background: #e0a800;
        box-shadow: 0 6px 12px rgba(255, 193, 7, 0.3);
    }

    .btn-danger {
        background: var(--danger-color);
    }
    .btn-danger:hover {
        background: #c82333;
        box-shadow: 0 6px 12px rgba(220, 53, 69, 0.3);
    }

    .btn-modify {
        background: var(--secondary-color);
    }
    .btn-modify:hover {
        background: #0069d9;
        box-shadow: 0 6px 12px rgba(0, 123, 255, 0.3);
    }

    /* ** ÙØµÙ„ Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ** */
    .management-separator {
        text-align: center;
        color: #6c757d;
        margin: 30px 0 15px;
        padding-top: 15px;
        border-top: 1px dashed #ced4da;
        font-weight: 600;
        font-size: 1.1rem;
    }
    
    /* ** Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…ÙÙˆÙ„Ù‘ÙØ¯ ** */
    .result { 
      margin-top: 25px; 
      padding: 15px;
      background: #e9f7ef;
      border: 1px dashed var(--primary-color);
      border-radius: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: 16px;
    }

    .result-label {
        color: var(--primary-hover);
        font-weight: 600;
        margin-bottom: 8px;
        font-size: 0.9rem;
    }

    #activationCodeDisplay {
        font-weight: bold; 
        color: var(--secondary-color);
        font-size: 1.2rem;
        direction: ltr; 
        font-family: 'Courier New', monospace;
        padding: 5px;
        -webkit-user-select: text !important;
        -moz-user-select: text !important;
        -ms-user-select: text !important;
        user-select: text !important;
    }
    
    .copy-btn {
        background: var(--secondary-color);
        width: auto !important;
        padding: 6px 15px !important;
        font-size: 14px !important;
        margin-top: 15px !important;
    }

    .copy-btn:hover {
        background: #0056b3;
    }
    
    /* ** Ø§Ù„ØªØ¬Ø§ÙˆØ¨ÙŠØ© (Responsive) ** */
    @media (max-width: 500px) {
        .card {
            padding: 25px 15px;
        }
    }
  </style>
</head>
<body>
  <div class="card">
    <h3>Ù„ÙˆØ­Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
    <input type="text" id="userNumber" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (USR-XXXX)" value="">
    <select id="duration">
      <option value="">Ø§Ø®ØªØ± Ù…Ø¯Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„</option>
      <option value="test">Ø§Ø®ØªØ¨Ø§Ø± (2 Ø³Ø§Ø¹Ø§Øª)</option>
      <option value="1m">Ø´Ù‡Ø± (30 ÙŠÙˆÙ…)</option>
      <option value="2m">Ø´Ù‡Ø±ÙŠÙ† (60 ÙŠÙˆÙ…)</option>
      <option value="3m">3 Ø£Ø´Ù‡Ø± (90 ÙŠÙˆÙ…)</option>
      <option value="6m">6 Ø£Ø´Ù‡Ø±</option>
      <option value="12m">Ø³Ù†Ø© ÙƒØ§Ù…Ù„Ø©</option>
    </select>

    <button onclick="activateUser()" id="activateButton">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¢Ù† ÙˆØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙˆØ¯</button>
    
    <div class="result" id="result" style="display:none;">
        <div class="result-label">Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…ÙÙˆÙ„Ù‘ÙØ¯:</div>
        <div id="activationCodeDisplay"></div>
        <button class="copy-btn" onclick="copyCode()">Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯</button>
    </div>

    <div class="management-separator">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„</div>
    
    <button onclick="suspendCode()" id="suspendButton" class="btn-suspend">Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª Ù„Ù„ÙƒÙˆØ¯</button>
    <button onclick="modifyCode()" id="modifyButton" class="btn-modify">ØªÙ…Ø¯ÙŠØ¯/ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¯Ø©</button>
    <button onclick="deleteCode()" id="deleteButton" class="btn-danger">Ø­Ø°Ù Ø§Ù„ÙƒÙˆØ¯ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹</button>

  </div>

  <script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbyuD0EUMjGq9_rf6NDpv3WlXtENX5P3wdd3U2i3wA2sSVZuQc7nBX4Cg-f6jgrtbcERxQ/exec";
    
    // ** ÙˆØ¸ÙŠÙØ© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© **
    async function sendManagementRequest(action, buttonId, duration = '') {
        const userNumber = document.getElementById('userNumber').value.trim();
        const button = document.getElementById(buttonId);

        // ** Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Serial Number) **
        if (!userNumber) {
            alert("âš ï¸ ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¹Ù„ÙˆÙŠ Ø£ÙˆÙ„Ø§Ù‹ Ù„ØªÙ†ÙÙŠØ° Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù/Ø§Ù„ØªØ¹Ø¯ÙŠÙ„/Ø§Ù„Ø­Ø°Ù).");
            return;
        }
        
        const originalText = button.textContent;
        button.textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...";
        button.disabled = true;

        let url = `${GAS_URL}?action=${action}&userNumber=${userNumber}`;
        if (duration) {
            url += `&duration=${duration}`;
        }
        
        try {
            const res = await fetch(url);
            const data = await res.json();

            if (data.status === 'success') {
                alert(`âœ… ØªÙ… ØªÙ†ÙÙŠØ° Ø¹Ù…Ù„ÙŠØ© ${originalText.split('/')[0]} Ø¨Ù†Ø¬Ø§Ø­ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${userNumber}`);
            } else if (data.status === 'not_found') {
                alert(`âŒ ÙØ´Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø³Ø¬Ù„ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø±Ù‚Ù…: ${userNumber}`);
            } else {
                alert(`âŒ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©: ${data.message || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ.'}`);
            }
        } catch (err) {
            alert("âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ø§Ù‹.");
            console.error("Fetch Error:", err);
        } finally {
            button.textContent = originalText;
            button.disabled = false;
        }
    }


    // ** ÙˆØ¸ÙŠÙØ© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (ÙˆØ¸ÙŠÙØªÙƒ Ø§Ù„Ø£ØµÙ„ÙŠØ©) **
    async function activateUser() {
      const userNumber = document.getElementById('userNumber').value.trim();
      const duration = document.getElementById('duration').value;
      const resultDiv = document.getElementById('result');
      const codeDisplay = document.getElementById('activationCodeDisplay');
      const activateButton = document.getElementById('activateButton');

      if (!userNumber || !duration) {
        alert("âš ï¸ Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ø®ØªØ± Ø§Ù„Ù…Ø¯Ø© Ø£ÙˆÙ„Ø§Ù‹");
        return;
      }
      
      activateButton.textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆÙ„ÙŠØ¯...";
      activateButton.disabled = true;
      resultDiv.style.display = 'none';

      try {
        const res = await fetch(`${GAS_URL}?action=activate&userNumber=${userNumber}&duration=${duration}`);
        const data = await res.json();

        if (data.code) {
          codeDisplay.textContent = data.code;
          resultDiv.style.display = 'flex';
          alert(`âœ… ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙˆØ¯ Ø¨Ù†Ø¬Ø§Ø­: ${data.code}`);
        } else {
          codeDisplay.textContent = "âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙˆØ¯";
          resultDiv.style.display = 'flex';
          alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªÙØ¹ÙŠÙ„.");
        }
      } catch (err) {
        codeDisplay.textContent = "âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù….";
        resultDiv.style.display = 'flex';
        alert("âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ø§Ù‹.");
      } finally {
         activateButton.textContent = "ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¢Ù† ÙˆØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙˆØ¯";
         activateButton.disabled = false;
      }
    }


    // ** ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© **

    // 1. Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙƒÙˆØ¯ Ù…Ø¤Ù‚ØªØ§Ù‹
    function suspendCode() {
        if (!document.getElementById('userNumber').value.trim()) {
            alert("âš ï¸ ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£ÙˆÙ„Ø§Ù‹.");
            return;
        }
        if (!confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥ÙŠÙ‚Ø§Ù ØªÙØ¹ÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø¤Ù‚ØªØ§Ù‹ØŸ")) return;
        sendManagementRequest('suspend', 'suspendButton');
    }

    // 2. ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¯Ø©/Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„
    function modifyCode() {
        if (!document.getElementById('userNumber').value.trim()) {
            alert("âš ï¸ ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£ÙˆÙ„Ø§Ù‹.");
            return;
        }
        const duration = document.getElementById('duration').value;
        if (!duration) {
             alert("âš ï¸ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø¯Ø© Ø§Ù„ØªÙ…Ø¯ÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ ØªÙ…Ø¯ÙŠØ¯.");
             return;
        }
        const durationText = document.querySelector('#duration option:checked').textContent;
        if (!confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªÙ…Ø¯ÙŠØ¯/ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªÙØ¹ÙŠÙ„ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù…Ø¯Ø©: ${durationText}ØŸ`)) return;
        sendManagementRequest('modify', 'modifyButton', duration);
    }
    
    // 3. Ø­Ø°Ù Ø§Ù„ÙƒÙˆØ¯ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹
    function deleteCode() {
        if (!document.getElementById('userNumber').value.trim()) {
            alert("âš ï¸ ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£ÙˆÙ„Ø§Ù‹.");
            return;
        }
        if (!confirm("ğŸš¨ ØªØ­Ø°ÙŠØ±: Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ ØªÙ…Ø§Ù…Ø§Ù‹ Ù…Ù† Ø­Ø°Ù Ø§Ù„ÙƒÙˆØ¯ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.")) return;
        sendManagementRequest('delete', 'deleteButton');
    }

    // ** ÙˆØ¸ÙŠÙØ© Ø§Ù„Ù†Ø³Ø® **
    function copyCode() {
        const code = document.getElementById('activationCodeDisplay').textContent;
        navigator.clipboard.writeText(code)
            .then(() => {
                alert("âœ… ØªÙ… Ù†Ø³Ø® ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!");
            })
            .catch(err => {
                console.error('ÙØ´Ù„ ÙÙŠ Ø§Ù„Ù†Ø³Ø®:', err);
                alert("âŒ ÙØ´Ù„ ÙÙŠ Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù†Ø³Ø® ÙŠØ¯ÙˆÙŠØ§Ù‹.");
            });
    }

    // ** ğŸ”’ ÙˆØ¸ÙŠÙØ© Ù…Ù†Ø¹ Ø§Ù„Ù†Ø³Ø® Ø¹Ø¨Ø± Ø£Ø­Ø¯Ø§Ø« Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ ÙˆØ§Ù„Ù…Ø§ÙˆØ³ ğŸ”’ **
    document.addEventListener('contextmenu', event => event.preventDefault()); 
    document.onkeydown = function(e) {
      if (e.keyCode == 123 || (e.ctrlKey && e.shiftKey && (e.keyCode == 73 || e.keyCode == 74)) || (e.ctrlKey && e.keyCode == 85) || (e.ctrlKey && e.keyCode == 67)) {
        return false;
      }
    };
  </script>
</body>
</html>